<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      const PROMISE_STATUS_PENDING = "pending";
      const PROMISE_STATUS_FULFILLED = "fulfilled";
      const PROMISE_STATUS_REJECTED = "rejected";
      // 1. 定义类
      class MyPromise {
        result = 0;
        status = PROMISE_STATUS_PENDING;
        constructor(exec) {
          // 定义两个不同状态下的存储数据方法
          // 箭头函数，保证this的指向
          const resolve = (value) => {
            if (this.status === PROMISE_STATUS_PENDING) {
              this.status = PROMISE_STATUS_FULFILLED;
              this.result = value;
            }
          };
          const reject = (reason) => {
            if (this.status === PROMISE_STATUS_PENDING) {
              this.status = PROMISE_STATUS_REJECTED;
              this.reason = reason;
            }
          };
          exec(resolve, reject);
        }
        // 2. 设计resolve存数据方法

        then(onFulfilled, onRejected) {
          this.onFulfilled = onFulfilled;
          this.onRejected = onRejected;
        }
      }
      const p1 = new MyPromise((resolve, reject) => {
        reject(1);
      });
      console.log(p1.reason);
    </script>
  </body>
</html>
